{#
/**
 * Layout principal pour TOUTES les pages - page.html.twig
 * Template de base pour la plateforme eGov S√©n√©gal
 */
#}

{{ attach_library('egov_theme/global-styling') }}

<div class="page-wrapper">

    {# ========== HEADER ========== #}
    <header class="page-header">
        <!-- Navigation -->
        <nav>
            <div class="logo">
                <img src="/themes/custom/egov_theme/images/senegal.png" alt="Logo Interop√©rabilit√© S√©n√©gal" style="width: 60px; height: 60px; object-fit: contain;">
                <div class="logo-text">
                    <h1>Jokkoo</h1>
                    <div class="logo-subtitle">Plateforme d'Interop√©rabilit√©</div>
                </div>
            </div>



            {# Menu Desktop #}
            <div class="nav-menu-desktop">
                {% if page.primary_menu %}
                    {{ page.primary_menu }}
                {% endif %}
            </div>

            {# Actions Mobile #}
            <div class="nav-actions-mobile">
                <button class="search-btn">üîç</button>
                <button class="hamburger-btn" id="hamburgerBtn">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </nav>

    </header>

    {# ========== CONTENU PRINCIPAL ========== #}
    <main class="page-main" role="main">
        {{ page.content }}
    </main>

    {{ include(active_theme_path() ~ '/templates/partials/footer.html.twig') }}


</div>

    
{{ attach_library('egov_theme/global-scripts') }}

<script>
    (function () {
        'use strict';

        console.log('Menu mobile inline - charg√©');

        function initMenu() {
            const hamburger = document.getElementById('hamburgerBtn');
            const menu = document.querySelector('.nav-menu-desktop');

            console.log('Init - Hamburger:', hamburger);
            console.log('Init - Menu:', menu);

            if (!hamburger || !menu) {
                console.error('√âl√©ments introuvables !');
                return;
            }

            // Clic hamburger
            hamburger.onclick = function (e) {
                e.preventDefault();
                console.log('CLICK HAMBURGER !');
                this.classList.toggle('active');
                menu.classList.toggle('open');
                console.log('Classes menu:', menu.className);
            };

            // Clic dehors
            document.onclick = function (e) {
                if (!menu.contains(e.target) && !hamburger.contains(e.target)) {
                    hamburger.classList.remove('active');
                    menu.classList.remove('open');
                }
            };

            // Sous-menus mobile
            const items = document.querySelectorAll('.nav-menu-desktop li.menu-item--expanded > a');
            items.forEach(function (link) {
                link.onclick = function (e) {
                    if (window.innerWidth <= 968) {
                        e.preventDefault();
                        this.parentElement.classList.toggle('submenu-open');
                        console.log('Sous-menu toggled');
                    }
                };
            });

            console.log('Menu initialis√© OK');
        }

        // Lancer l'init
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initMenu);
        } else {
            initMenu();
        }
    })();
</script>